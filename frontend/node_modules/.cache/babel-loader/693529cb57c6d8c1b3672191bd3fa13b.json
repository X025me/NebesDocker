{"ast":null,"code":"// helper function to output a clearer visualization\n// of the current node and its descendents\nconst util = require('util');\n\nconst relpath = require('./relpath.js');\n\nclass ArboristNode {\n  constructor(tree, path) {\n    this.name = tree.name;\n    if (tree.packageName && tree.packageName !== this.name) this.packageName = tree.packageName;\n    if (tree.version) this.version = tree.version;\n    this.location = tree.location;\n    this.path = tree.path;\n    if (tree.realpath !== this.path) this.realpath = tree.realpath;\n    if (tree.resolved !== null) this.resolved = tree.resolved;\n    if (tree.extraneous) this.extraneous = true;\n    if (tree.dev) this.dev = true;\n    if (tree.optional) this.optional = true;\n    if (tree.devOptional && !tree.dev && !tree.optional) this.devOptional = true;\n    if (tree.peer) this.peer = true;\n    if (tree.inBundle) this.bundled = true;\n    if (tree.inDepBundle) this.bundler = tree.getBundler().location;\n    const bd = tree.package && tree.package.bundleDependencies;\n    if (bd && bd.length) this.bundleDependencies = bd;\n    if (tree.inShrinkwrap) this.inShrinkwrap = true;else if (tree.hasShrinkwrap) this.hasShrinkwrap = true;\n    if (tree.error) this.error = treeError(tree.error);\n    if (tree.errors && tree.errors.length) this.errors = tree.errors.map(treeError); // edgesOut sorted by name\n\n    if (tree.edgesOut.size) {\n      this.edgesOut = new Map([...tree.edgesOut.entries()].sort(([a], [b]) => a.localeCompare(b, 'en')).map(([name, edge]) => [name, new EdgeOut(edge)]));\n    } // edgesIn sorted by location\n\n\n    if (tree.edgesIn.size) {\n      this.edgesIn = new Set([...tree.edgesIn].sort((a, b) => a.from.location.localeCompare(b.from.location, 'en')).map(edge => new EdgeIn(edge)));\n    }\n\n    if (tree.workspaces && tree.workspaces.size) {\n      this.workspaces = new Map([...tree.workspaces.entries()].map(([name, path]) => [name, relpath(tree.root.realpath, path)]));\n    } // fsChildren sorted by path\n\n\n    if (tree.fsChildren.size) {\n      this.fsChildren = new Set([...tree.fsChildren].sort(({\n        path: a\n      }, {\n        path: b\n      }) => a.localeCompare(b, 'en')).map(tree => printableTree(tree, path)));\n    } // children sorted by name\n\n\n    if (tree.children.size) {\n      this.children = new Map([...tree.children.entries()].sort(([a], [b]) => a.localeCompare(b, 'en')).map(([name, tree]) => [name, printableTree(tree, path)]));\n    }\n  }\n\n}\n\nclass ArboristVirtualNode extends ArboristNode {\n  constructor(tree, path) {\n    super(tree, path);\n    this.sourceReference = printableTree(tree.sourceReference, path);\n  }\n\n}\n\nclass ArboristLink extends ArboristNode {\n  constructor(tree, path) {\n    super(tree, path);\n    this.target = printableTree(tree.target, path);\n  }\n\n}\n\nconst treeError = ({\n  code,\n  path\n}) => ({\n  code,\n  ...(path ? {\n    path\n  } : {})\n}); // print out edges without dumping the full node all over again\n// this base class will toJSON as a plain old object, but the\n// util.inspect() output will be a bit cleaner\n\n\nclass Edge {\n  constructor(edge) {\n    this.type = edge.type;\n    this.name = edge.name;\n    this.spec = edge.spec || '*';\n    if (edge.error) this.error = edge.error;\n  }\n\n} // don't care about 'from' for edges out\n\n\nclass EdgeOut extends Edge {\n  constructor(edge) {\n    super(edge);\n    this.to = edge.to && edge.to.location;\n  }\n\n  [util.inspect.custom]() {\n    return `{ ${this.type} ${this.name}@${this.spec}${this.to ? ' -> ' + this.to : ''}${this.error ? ' ' + this.error : ''} }`;\n  }\n\n} // don't care about 'to' for edges in\n\n\nclass EdgeIn extends Edge {\n  constructor(edge) {\n    super(edge);\n    this.from = edge.from && edge.from.location;\n  }\n\n  [util.inspect.custom]() {\n    return `{ ${this.from || '\"\"'} ${this.type} ${this.name}@${this.spec}${this.error ? ' ' + this.error : ''} }`;\n  }\n\n}\n\nconst printableTree = (tree, path = []) => {\n  if (!tree) return tree;\n  const Cls = tree.isLink ? ArboristLink : tree.sourceReference ? ArboristVirtualNode : ArboristNode;\n\n  if (path.includes(tree)) {\n    const obj = Object.create(Cls.prototype);\n    return Object.assign(obj, {\n      location: tree.location\n    });\n  }\n\n  path.push(tree);\n  return new Cls(tree, path);\n};\n\nmodule.exports = printableTree;","map":{"version":3,"sources":["/Users/johndoe/Nebe-data-vistualization/node_modules/npm/node_modules/@npmcli/arborist/lib/printable.js"],"names":["util","require","relpath","ArboristNode","constructor","tree","path","name","packageName","version","location","realpath","resolved","extraneous","dev","optional","devOptional","peer","inBundle","bundled","inDepBundle","bundler","getBundler","bd","package","bundleDependencies","length","inShrinkwrap","hasShrinkwrap","error","treeError","errors","map","edgesOut","size","Map","entries","sort","a","b","localeCompare","edge","EdgeOut","edgesIn","Set","from","EdgeIn","workspaces","root","fsChildren","printableTree","children","ArboristVirtualNode","sourceReference","ArboristLink","target","code","Edge","type","spec","to","inspect","custom","Cls","isLink","includes","obj","Object","create","prototype","assign","push","module","exports"],"mappings":"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","sourcesContent":["// helper function to output a clearer visualization\n// of the current node and its descendents\n\nconst util = require('util')\nconst relpath = require('./relpath.js')\n\nclass ArboristNode {\n  constructor (tree, path) {\n    this.name = tree.name\n    if (tree.packageName && tree.packageName !== this.name)\n      this.packageName = tree.packageName\n    if (tree.version)\n      this.version = tree.version\n    this.location = tree.location\n    this.path = tree.path\n    if (tree.realpath !== this.path)\n      this.realpath = tree.realpath\n    if (tree.resolved !== null)\n      this.resolved = tree.resolved\n    if (tree.extraneous)\n      this.extraneous = true\n    if (tree.dev)\n      this.dev = true\n    if (tree.optional)\n      this.optional = true\n    if (tree.devOptional && !tree.dev && !tree.optional)\n      this.devOptional = true\n    if (tree.peer)\n      this.peer = true\n    if (tree.inBundle)\n      this.bundled = true\n    if (tree.inDepBundle)\n      this.bundler = tree.getBundler().location\n    const bd = tree.package && tree.package.bundleDependencies\n    if (bd && bd.length)\n      this.bundleDependencies = bd\n    if (tree.inShrinkwrap)\n      this.inShrinkwrap = true\n    else if (tree.hasShrinkwrap)\n      this.hasShrinkwrap = true\n    if (tree.error)\n      this.error = treeError(tree.error)\n    if (tree.errors && tree.errors.length)\n      this.errors = tree.errors.map(treeError)\n\n    // edgesOut sorted by name\n    if (tree.edgesOut.size) {\n      this.edgesOut = new Map([...tree.edgesOut.entries()]\n        .sort(([a], [b]) => a.localeCompare(b, 'en'))\n        .map(([name, edge]) => [name, new EdgeOut(edge)]))\n    }\n\n    // edgesIn sorted by location\n    if (tree.edgesIn.size) {\n      this.edgesIn = new Set([...tree.edgesIn]\n        .sort((a, b) => a.from.location.localeCompare(b.from.location, 'en'))\n        .map(edge => new EdgeIn(edge)))\n    }\n\n    if (tree.workspaces && tree.workspaces.size) {\n      this.workspaces = new Map([...tree.workspaces.entries()]\n        .map(([name, path]) => [name, relpath(tree.root.realpath, path)]))\n    }\n\n    // fsChildren sorted by path\n    if (tree.fsChildren.size) {\n      this.fsChildren = new Set([...tree.fsChildren]\n        .sort(({path: a}, {path: b}) => a.localeCompare(b, 'en'))\n        .map(tree => printableTree(tree, path)))\n    }\n\n    // children sorted by name\n    if (tree.children.size) {\n      this.children = new Map([...tree.children.entries()]\n        .sort(([a], [b]) => a.localeCompare(b, 'en'))\n        .map(([name, tree]) => [name, printableTree(tree, path)]))\n    }\n  }\n}\n\nclass ArboristVirtualNode extends ArboristNode {\n  constructor (tree, path) {\n    super(tree, path)\n    this.sourceReference = printableTree(tree.sourceReference, path)\n  }\n}\n\nclass ArboristLink extends ArboristNode {\n  constructor (tree, path) {\n    super(tree, path)\n    this.target = printableTree(tree.target, path)\n  }\n}\n\nconst treeError = ({code, path}) => ({\n  code,\n  ...(path ? { path } : {}),\n})\n\n// print out edges without dumping the full node all over again\n// this base class will toJSON as a plain old object, but the\n// util.inspect() output will be a bit cleaner\nclass Edge {\n  constructor (edge) {\n    this.type = edge.type\n    this.name = edge.name\n    this.spec = edge.spec || '*'\n    if (edge.error)\n      this.error = edge.error\n  }\n}\n\n// don't care about 'from' for edges out\nclass EdgeOut extends Edge {\n  constructor (edge) {\n    super(edge)\n    this.to = edge.to && edge.to.location\n  }\n\n  [util.inspect.custom] () {\n    return `{ ${this.type} ${this.name}@${this.spec}${\n      this.to ? ' -> ' + this.to : ''\n    }${\n      this.error ? ' ' + this.error : ''\n    } }`\n  }\n}\n\n// don't care about 'to' for edges in\nclass EdgeIn extends Edge {\n  constructor (edge) {\n    super(edge)\n    this.from = edge.from && edge.from.location\n  }\n\n  [util.inspect.custom] () {\n    return `{ ${this.from || '\"\"'} ${this.type} ${this.name}@${this.spec}${\n      this.error ? ' ' + this.error : ''\n    } }`\n  }\n}\n\nconst printableTree = (tree, path = []) => {\n  if (!tree)\n    return tree\n\n  const Cls = tree.isLink ? ArboristLink\n    : tree.sourceReference ? ArboristVirtualNode\n    : ArboristNode\n  if (path.includes(tree)) {\n    const obj = Object.create(Cls.prototype)\n    return Object.assign(obj, { location: tree.location })\n  }\n  path.push(tree)\n  return new Cls(tree, path)\n}\n\nmodule.exports = printableTree\n"]},"metadata":{},"sourceType":"script"}